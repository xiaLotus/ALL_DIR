<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>報案系統資料整理</title>
  <script src="static/js/vue.global.js"></script>
  <script src="static/js/chart.js"></script>
  <script src="static/js/chartjs-plugin-datalabels.js"></script>
  <script src="static/js/tailwinds.js"></script>
  
</head>
<body class="bg-gray-900 text-white min-h-screen p-10">
  <div id="app" class="mx-auto">
    <!-- 上方 Tabs -->
    <div class="flex justify-center gap-4 mb-6">
        <button
            v-for="(tab, index) in tabs"
            :key="tab"
            class="px-4 py-2 rounded-full transition"
            :class="activeTab === index ? 'bg-white text-black font-bold' : 'bg-gray-700 hover:bg-gray-600'"
            @click="setActiveTab(index)"
        >
        {{ tab }}
        </button>
    </div>
    <div v-show="activeTab === 0">
        <h1 class="text-3xl font-bold mb-6 text-center">{{ this.week }} - 報案柱狀圖</h1>
        <div class="flex justify-center">
            <div class="w-full max-w-7xl aspect-[2/1]">
              <canvas id="myChart" class="bg-white p-4 rounded-xl w-full h-full"></canvas>
            </div>
          </div>
    </div>

    <div v-show="activeTab === 1">
        <h1 class="text-3xl font-bold mb-6 text-center">{{ this.week }} - 每日過帳件數柱狀圖</h1>
        <div class="flex justify-center">
            <div class="w-full max-w-7xl aspect-[2/1]">
              <canvas id="dailyChart" class="bg-white p-4 rounded-xl w-full h-full"></canvas>
            </div>
          </div>
    </div>

    <div v-show="activeTab === 2">
        <h1 class="text-3xl font-bold mb-6 text-center">每週異常分類柱狀圖</h1>
        <div class="flex justify-center mt-4">
            <div class="w-full max-w-7xl aspect-[2/1]">
              <canvas id="weeklyChart" class="bg-white p-4 rounded-xl w-full h-full"></canvas>
            </div>
          </div>
    </div>

    <div v-show="activeTab === 3">
        <h1 class="text-3xl font-bold mb-6 text-center">{{ this.week }} - 工廠異常總覽</h1>
        <div class="overflow-x-auto mt-4">
            <table class="table-auto w-full text-sm text-left text-white border border-white/20">
                <thead class="bg-gray-700">
                <tr>
                    <th class="px-4 py-2">報案類別</th>
                    <th class="px-4 py-2">ASEF1</th>
                    <th class="px-4 py-2">ASEF3</th>
                    <th class="px-4 py-2">ASEF5</th>
                    <th class="px-4 py-2">總計</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="item in summaryItems" :key="item.label" class="border-t border-white/10">
                    <td class="px-4 py-2">{{ item.label }}</td>
                    <td class="px-4 py-2">{{ item.asef1 }}</td>
                    <td class="px-4 py-2">{{ item.asef3 }}</td>
                    <td class="px-4 py-2">{{ item.asef5 }}</td>
                    <td class="px-4 py-2">{{ item.總計 }}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div v-show="activeTab === 4">
        <h1 class="text-3xl font-bold mb-6 text-center">{{ this.week }} -  Top 3 站點統計</h1>
        <div class="overflow-x-auto mt-4">
        <table class="table-fixed w-full text-sm text-white">
            <thead class="bg-gray-700">
            <tr>
                <th class="w-1/4 px-4 py-2 text-left">報案類別</th>
                <th colspan="3" class="text-center px-4 py-2">站點（最多 3 個）</th>
                <th class="w-1/4 px-4 py-2 text-center">總計</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="row in top3Stats" :key="row.category" class="bg-gray-800">
                <td class="px-4 py-2 font-semibold w-1/4">{{ row.category }}</td>
                <td v-for="item in row.operList" :key="item" class="text-center w-1/4 px-2 py-2">
                {{ item }}
                </td>
                <td class="text-center font-bold text-amber-400 px-4 py-2">{{ row.totalCount }}</td>
            </tr>
            </tbody>
        </table>
        </div>
    </div>

    <div v-show="activeTab === 5">
        <h1 class="text-3xl font-bold mb-6 text-center">{{ this.week }} - 報案系統詳細列表</h1>
        <div class="overflow-x-auto mt-4 max-h-[800px]">
          <table class="table-auto w-full text-base text-white">
            <thead class="bg-gray-700 sticky top-0 z-10">
              <tr>
                <th class="px-4 py-2">廠別</th>
                <th class="px-4 py-2">棟別</th>
                <th class="px-4 py-2">樓層</th>
                <th class="px-4 py-2">站點</th>
                <th class="px-4 py-2">MachID</th>
                <th class="px-4 py-2">問題分類</th>
                <th class="px-4 py-2">問題描述</th>
                <th class="px-4 py-2">問題子分類</th>
                <th class="px-4 py-2">報案時間</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(item, index) in detailedData" :key="index" class="bg-gray-800 border-b border-white/10">
                <td class="px-4 py-2">{{ item.廠別 }}</td>
                <td class="px-4 py-2">{{ item.棟別 }}</td>
                <td class="px-4 py-2">{{ item.樓層 }}</td>
                <td class="px-4 py-2">{{ item.站點 }}</td>
                <td class="px-4 py-2">{{ item.MachID }}</td>
                <td class="px-4 py-2">{{ item.問題分類 }}</td>
                <td class="px-4 py-2 max-w-[300px] break-words whitespace-pre-wrap">{{ item.問題描述 }}</td>
                <td class="px-4 py-2">{{ item.問題子分類 }}</td>
                <td class="px-4 py-2">{{ item.報案時間 }}</td>
              </tr>
            </tbody>
          </table>
            </div>
          </div>
          
    </div>
      
  </div>

  <script src="static/js/app.js"></script>
</body>
</html>
